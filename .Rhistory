geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("mean",values=c("dashed"=1))
graph
graph$cat<-rep('segment legend', length(graph$year))
graph
colnames(graph)<-c("year","month","home_win", "freq", "test", "Date", "covid_before_after","segment legend")
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq)), linetype = 'segment legend', col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("segment legend",values=c("segment legend"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'segment legend'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("segment legend",values=c("segment legend"=2))
graph$cat<-rep('Share of home win mean', length(graph$year))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Share of home win mean",values=c("Share of home win mean"=2))
graph$cat<-rep('Share of home win mean', length(graph$year))
colnames(graph)<-c("year","month","home_win", "freq", "test", "Date", "covid_before_after","Share of home win mean")
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Share of home win mean",values=c("Share of home win mean"=2))
#home win percentage
graph <- df_restr %>% mutate(year = year(date),month = month(date)) %>% group_by(year, month, team_status, win) %>% summarise(number=n()) %>% mutate(freq= number/sum(number))%>% mutate(
home_win = case_when(
team_status == 'HomeTeam' & win == 1 ~ 'Home win',
team_status == 'HomeTeam' & win == 0 ~ 'Away win',
team_status == 'AwayTeam' & win == 1 ~ 'Away win',
team_status == 'AwayTeam' & win == 0 ~ 'Home win',
win == 2 ~ 'Draw')) %>% group_by(year, month, home_win, freq) %>% summarise() %>%
mutate(test = paste(paste('01',month),year), Date = as.Date(test, format = "%d %m %Y")) %>%
mutate(covid_before_after = as.factor(case_when(
Date >= "2020-03-12" & Date <= "2021-06-01"~ "In-covid",
Date <= "2020-03-12" ~"Pre-covid",
TRUE ~ "Post-covid")))
graph$cat<-rep('Share of home win mean', length(graph$year))
colnames(graph)<-c("year","month","home_win", "freq", "test", "Date", "covid_before_after","Share of home win mean")
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Share of home win mean",values=c("Share of home win mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Share of home win mean",values=c("Mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2))+
scale_linetype_manual(values=c("Share of away win mean"=2))
graph$cat2 <-  rep('Share of away win mean', length(graph$year))
colnames(graph)<-c("year","month","home_win", "freq", "test", "Date", "covid_before_after","Share of home win mean", 'Share of away win mean')
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2))+
scale_linetype_manual(values=c("Share of away win mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=1,"Share of away win mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2))
graph
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2, "Share of draw"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean', color = 'name1'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2, "Share of draw"=2)) +
scale_color_manual(values=c("name1"="darkred", "name2"="green", "name3"="blue"))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2, "Share of draw"=2)) +
scale_color_manual(values=c("name1"="darkred", "name2"="green", "name3"="blue"))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2, "Share of draw"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col = 'blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2, "Share of draw mean"=2))
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean', col='name1')) +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2, "Share of draw mean"=2))+
scale_colour_manual(
values = c("name1" = "blue", "AL1" = "blue", "ISQG" = "purple"),
)
graph %>% ggplot(aes(x=Date, y=freq, color = home_win)) + geom_line() +
geom_rect(aes(xmin = as.Date("2020-03-12", format = "%Y-%m-%d"), xmax = as.Date("2021-06-01", format = "%Y-%m-%d"), ymin = -Inf, ymax = Inf), fill = "blue", alpha = 0.0025)+
labs(color = 'Match result') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Home win'))$freq), linetype = 'Share of home win mean'), col='blue') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Home win'))$freq)), linetype = 'dashed', col = 'blue') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Draw'))$freq)), linetype = 'dashed', col = 'green') +
geom_segment(aes(x=as.Date('2018-08-01', format = "%Y-%m-%d"), xend = as.Date("2020-03-12", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Pre-covid' & home_win == 'Away win'))$freq), linetype = 'Share of away win mean'), col = 'red') +
geom_segment(aes(x=as.Date('2020-03-12', format = "%Y-%m-%d"), xend = as.Date("2021-06-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'In-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
geom_segment(aes(x=as.Date('2021-06-01', format = "%Y-%m-%d"), xend = as.Date("2022-05-01", format = "%Y-%m-%d"), y = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq), yend = mean((graph%>%filter(covid_before_after == 'Post-covid' & home_win == 'Away win'))$freq)), linetype = 'dashed', col = 'red') +
ylab('Frequency (%)') + xlab("Date") + ggtitle("Match results") +
annotate("text", x=as.Date("2020-09-12", format = "%Y-%m-%d"), y=0, label="Covid-19 period", col = 'blue') +
scale_linetype_manual("Mean",values=c("Share of home win mean"=2,"Share of away win mean"=2, "Share of draw mean"=2))
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
lapply(c("dplyr","chron","ggplot2","tidyr","questionr","survival","forcats","tidyselect",
"data.table","table1","lubridate", "ggpubr","viridis","finalfit","survminer",
"ggpubr", "ggthemes", "gridExtra", "rstatix","stringr",
"wesanderson","kableExtra", "naniar","boot","scales","ggsci", "stringr",
"Hmisc","DescTools","swimplot", 'stats', 'EnvStats', 'finalfit'),
library, character.only=TRUE)
Sys.setlocale("LC_TIME", "English")
load("2_online_shopping.RData")
set.seed(435) #set the seed for reproducible results
df<-Data
#Below, I change the names of the variables, change their type, and put some labels
df <- df %>% mutate(
#from the e-commerce website
n_admin_page = as.numeric(Administrative) %>% ff_label("Number of administrative pages visited"),
time_admin_page = as.numeric(Administrative_Duration)%>% ff_label("Time spent on administrative pages"),
n_info_page = as.numeric(Informational) %>% ff_label("Number of informational-type pages visited"),
time_info_page =as.numeric(Informational_Duration) %>% ff_label("Time spent on informational-type pages"),
n_prod_rel_page = as.numeric(ProductRelated) %>% ff_label("Number of product related type pages visited"),
time_prod_rel_page = as.numeric(ProductRelated_Duration)%>% ff_label(" Time spent on product related type pages"),
#derived from a date
month = as.factor(Month) %>% ff_label("Month of the session"),
weekend = as.factor(Weekend) %>% ff_label("Indicator of the session during a week-end"),
special_day = as.numeric(SpecialDay)%>% ff_label("Closeness to a Special day"),
#from google analytics
bounce_rates = as.numeric(BounceRates) %>% ff_label("Average bounce rate of pages visited"),
exit_rates = as.numeric(ExitRates) %>% ff_label('Average exit of pages visited'),
page_values= as.numeric(PageValues) %>% ff_label('Average page value of pages visited'),
operating_systems = as.factor(OperatingSystems)%>% ff_label("Operating systems of the user"),
browser = as.factor(Browser)%>% ff_label("Browser of the user"),
region = as.factor(Region) %>% ff_label("Geographic region"),
traffic_type = as.factor(TrafficType)%>% ff_label("Traffic type"),
visitor_type = as.factor(VisitorType)%>% ff_label("Visitor type"),
purchase = as.factor(Revenue)%>% ff_label("Indicator of a purchase made or not")
)
df <- df %>% mutate(
purchase = as.factor(case_when(
purchase == F ~ 0,
purchase == T ~ 1
)))
#final dataframe
df <- df %>% select(purchase,visitor_type,traffic_type,region,browser, operating_systems,page_values, exit_rates, bounce_rates, special_day, weekend, month, time_prod_rel_page, n_prod_rel_page, time_info_page, n_info_page,time_admin_page, n_admin_page)
buy <- 100*(1 - sum(df$purchase==0)/length(df$purchase)) #percentage of purchases
View(df)
View(df)
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% ggplot( aes(x=month, y = freq, color = purchase))
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% ggplot( aes(x=month, y = freq, color = purchase)) + geom_line()
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% ggplot( aes(x=month, y = freq, fill = purchase)) + geom_line()
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number))
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x=month, y = freq)) + geom_line()
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x=month, y = freq)) + geom_point()
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x=month, y = freq)) + geom_line()
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1)
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% ggplot( aes(x=month, y = freq)) + geom_line()
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% ggplot( aes(x=month, y = freq, color = purchase)) + geom_line()
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number))
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% ggplot(aes(x=month, y = freq, color = purchase)) + geom_point()
df %>% group_by(month, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number))
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x=month, y = freq, color = visitor_type)) + geom_point()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x=month, y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x=month, y = freq, color = visitor_type)) + geom_boxplot()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x=month, y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x=as.Date(month, format='%m'), y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x= paste(paste('01',month),'2020'), Date = as.Date(test, format = "%d %m %Y"), y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% ggplot( aes(x= as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y"), y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% mutate( Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y")) %>% ggplot( aes(x=Date , y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% mutate( Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y"))
paste(paste('01',month),'2020'
)
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% mutate(month = as.numeric(month), Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y"))
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% mutate(month = as.numeric(month), Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y")) %>% ggplot( aes(x=Date , y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% mutate(month = as.numeric(month), Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y")) %>% filter(visitor_type != 'Other') %>% ggplot( aes(x=Date , y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, bounce_rates, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% mutate(month = as.numeric(month), Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y")) %>% filter(visitor_type != 'Other') %>% ggplot( aes(x=Date , y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, purchase,bounce_rates) %>% summarise()
df %>% group_by(month, purchase) %>% summarise() %>% mutate(mean = mean(bounce_rates))
df %>% group_by(month, purchase) %>% summarise()
df %>% group_by(month, purchase, bounce_rates) %>% summarise()
df %>% group_by(month, purchase, bounce_rates) %>% summarise() %>% filter(purchase == 1) %>% mutate(month = as.numeric(month), Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y")) %>% ggplot(aes(x=Date , y = bounce_rates, color = purchase)) + geom_boxplot()
df %>% group_by(month, purchase, bounce_rates) %>% summarise() %>% mutate(month = as.numeric(month), Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y")) %>% ggplot(aes(x=Date , y = bounce_rates, color = purchase)) + geom_boxplot()
df %>% group_by(month, purchase, bounce_rates) %>% summarise() %>% mutate(month = as.numeric(month), Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y")) %>% ggplot(aes(x=purchase , y = bounce_rates, color = Date)) + geom_boxplot()
df %>% group_by(month, purchase, bounce_rates) %>% summarise() %>%  ggplot(aes(x=purchase , y = bounce_rates, color = month)) + geom_boxplot()
df %>% group_by(month, visitor_type, purchase) %>% summarise(number= n()) %>% mutate(freq = number/sum(number)) %>% filter(purchase == 1) %>% mutate(month = as.numeric(month), Date = as.Date(paste(paste('01',month),'2020'), format = "%d %m %Y")) %>% filter(visitor_type != 'Other') %>% ggplot( aes(x=Date , y = freq, color = visitor_type)) + geom_line()
df %>% group_by(month, purchase, bounce_rates) %>% summarise() %>%  ggplot(aes(x=purchase , y = bounce_rates, color = month)) + geom_boxplot()
df %>% group_by(month, purchase, exit_rates) %>% summarise() %>%  ggplot(aes(x=purchase , y = sqrt(exit_rates), color = month)) + geom_boxplot()
require(zoo)
require(tseries)
library(dplyr)
#fonctions utilisées dans le code
signif <- function(estim){ #fonction de test des significations individuelles des coefficients
coef <- estim$coef
se <- sqrt(diag(estim$var.coef))
t <- coef/se
pval <- (1-pnorm(abs(t)))*2
return(rbind(coef,se,pval))
}
Qtests <- function(series, k, fitdf=0) {
pvals <- apply(matrix(1:k), 1, FUN=function(l) {
pval <- if (l<=fitdf) NA else Box.test(series, lag=l, type="Ljung-Box", fitdf=fitdf)$p.value
return(c("lag"=l,"pval"=pval))
})
return(t(pvals))
}
arimafit <- function(estim){
adjust <- round(signif(estim),3)
pvals <- Qtests(estim$residuals,24,length(estim$coef)-1)
pvals <- matrix(apply(matrix(1:24,nrow=6),2,function(c) round(pvals[c,],3)),nrow=6)
colnames(pvals) <- rep(c("lag", "pval"),4)
cat("tests de nullite des coefficients :\n")
print(adjust)
cat("\n tests d'absence d'autocorrelation des residus : \n")
print(pvals)
}
modelchoice <- function(p,q,data=xm, k=24){
estim <- try(arima(data, c(p,0,q),optim.control=list(maxit=20000)))
if (class(estim)=="try-error") return(c("p"=p,"q"=q,"arsignif"=NA,"masignif"=NA,"resnocorr"=NA, "ok"=NA))
arsignif <- if (p==0) NA else signif(estim)[3,p]<=0.05
masignif <- if (q==0) NA else signif(estim)[3,p+q]<=0.05
resnocorr <- sum(Qtests(estim$residuals,24,length(estim$coef)-1)[,2]<=0.05,na.rm=T)==0
checks <- c(arsignif,masignif,resnocorr)
ok <- as.numeric(sum(checks,na.rm=T)==(3-sum(is.na(checks))))
return(c("p"=p,"q"=q,"arsignif"=arsignif,"masignif"=masignif,"resnocorr"=resnocorr,"ok"=ok))
}
armamodelchoice <- function(pmax,qmax){
pqs <- expand.grid(0:pmax,0:qmax)
t(apply(matrix(1:dim(pqs)[1]),1,function(row) {
p <- pqs[row,1]; q <- pqs[row,2]
cat(paste0("Computing ARMA(",p,",",q,") \n"))
modelchoice(p,q)
}))
}
#base de données
setwd("C:/Users/candi/Desktop/ETUDES/ENSAE2A/semestre 2/séries temporelles/series temp/series_temp")
data <- read.csv('valeurs_mensuelles_pesticides.csv', sep=";")
data <- data[2]
data <- as.data.frame(data[-(1:3),])#on enlève les premières lignes qui ne sont pas des données
indice <- as.data.frame(as.numeric(unlist(data)))
xm.source <- zoo(indice[[1]]) #convertit le premier element de data en serie temporelle de type "zoo"
T <- length(xm.source)
test <- tail(xm.source, n=2) #pour comparer nos prévisions avec les vraies données
xm <- xm.source[(250):(T-2)] #pour le modèle
#mean(xm.source)
plot(xm, xaxt="n") #plot des données
axis(side=1,at=seq(0,400,12)) #pour mettre l'axe x
#on retire la moyenne de xm
xm <- xm - mean(xm)
#mean(xm.source)
plot(xm, xaxt="n") #plot des données
par(mfrow=c(1,2))
acf(xm)
pacf(xm) #saisonnalité apparente : saisonnalité de 12 donc annuelle, avec été et hiver différenciés (corr pos et neg)
pp.test(xm) #test de philippe perron, on rejette à 1% l'hypothèse que la série n'est pas stationnaire
